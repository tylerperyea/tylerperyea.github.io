<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Permissions-Policy" content="interest-cohort=()">
  <style>
      body{
	font-family:monospace;
      }
      textarea{
        width:100%;
        min-height:200px;
      }
      div.panel{
        display:inline-block;
        padding:10px;
      }
	    div.panel.middle{
		    vertical-align: bottom;
        padding-bottom: 100px;
	    }
      div.panel.col-3{
        display:inline-block;
        padding:10px;
	      width:33%;
      }
      div.panel.full{
        display:block;
      }
      .middle button {
        display: block;
        width: 200px;
      }
      textarea.nowrap{
        white-space: pre;
        overflow-wrap: normal;
        overflow-x: scroll;
      }
  </style>
  <script src="jschemify.js"></script>

  <script>
    let examples={
	"atorvastatin":`
  Marvin  01132102302D          

 41 44  0  0  1  0            999 V2000
   -2.2382   -2.6126    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.8246   -2.5747    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   -1.5524   -2.0825    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -1.9521   -3.4287    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -1.0728   -3.4119    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.9954   -2.1751    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.0085   -2.2339    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -3.7611   -2.6083    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   -0.3240   -3.8578    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    3.7779   -2.5916    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    4.5267   -2.1372    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.7220   -3.8411    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.9954   -1.2957    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   -1.5693   -1.2032    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.7530   -2.6588    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    4.5015   -1.2621    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    3.0080   -2.1708    0.0000 C   0  0  1  0  0  0  0  0  0  0  0  0
    2.2633   -2.6252    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.3029   -4.6741    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.3323   -3.4287    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -4.5100   -2.1708    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    1.0138   -4.6403    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    5.2924   -2.5578    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    1.4934   -2.2087    0.0000 C   0  0  2  0  0  0  0  0  0  0  0  0
    0.9971   -3.8284    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.3575   -5.0695    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    1.6701   -5.0863    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0
    2.9912   -1.2957    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    1.4767   -1.3336    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   -3.4246   -3.4287    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.7009   -4.6151    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.2677   -0.7025    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.9130   -0.7025    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -4.5352   -1.3462    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -5.1663   -2.5957    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -3.3867   -4.9811    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -4.1145   -3.7863    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -5.8394   -2.2129    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -5.2041   -0.9634    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -5.8562   -1.3926    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -4.0851   -4.5605    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
  2  3  1  0  0  0  0
  3  1  2  0  0  0  0
  4  1  1  0  0  0  0
  5  4  2  0  0  0  0
  6  1  1  0  0  0  0
  7  2  1  0  0  0  0
  8  6  1  0  0  0  0
  9  5  1  0  0  0  0
 10 17  1  0  0  0  0
 11 10  1  0  0  0  0
 12  4  1  0  0  0  0
 13  6  2  0  0  0  0
 14  3  1  0  0  0  0
 15  7  1  0  0  0  0
 16 11  2  0  0  0  0
 17 18  1  0  0  0  0
 18 24  1  0  0  0  0
 19  9  1  0  0  0  0
 20  9  2  0  0  0  0
 21  8  1  0  0  0  0
 22 25  2  0  0  0  0
 23 11  1  0  0  0  0
 24 15  1  0  0  0  0
 25 20  1  0  0  0  0
 26 19  2  0  0  0  0
 27 22  1  0  0  0  0
 17 28  1  1  0  0  0
 24 29  1  1  0  0  0
 30 12  1  0  0  0  0
 31 12  2  0  0  0  0
 32 14  1  0  0  0  0
 33 14  1  0  0  0  0
 34 21  1  0  0  0  0
 35 21  2  0  0  0  0
 36 31  1  0  0  0  0
 37 30  2  0  0  0  0
 38 35  1  0  0  0  0
 39 34  2  0  0  0  0
 40 39  1  0  0  0  0
 41 36  2  0  0  0  0
  5  2  1  0  0  0  0
 41 37  1  0  0  0  0
 22 26  1  0  0  0  0
 40 38  2  0  0  0  0
M  END`,
	    "oxytocin":`DEMOXYTOCIN
   JSDraw211142415102D

 70 72  0  0  1  0              0 V2000
   14.6234  -13.1459    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   13.0634  -13.1459    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   12.2832  -14.4969    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   10.7233  -14.4969    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   13.0634  -15.8479    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   15.4032  -11.7950    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   14.6234  -10.4438    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   16.9631  -11.7950    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   17.7433  -13.1459    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   16.9631  -14.4969    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   15.4032  -14.4969    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   17.7433  -15.8479    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   17.7433  -10.4438    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   19.3032  -10.4438    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   20.0830  -11.7950    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   20.0830   -9.0930    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   19.4487   -7.6679    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   20.6079   -6.6239    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   21.9590   -7.4041    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   21.6347   -8.9300    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   22.6784  -10.0893    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   24.2044   -9.7648    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   24.6863   -8.2812    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   26.2123   -7.9570    0.0000 S   0  0  0  0  0  0  0  0  0  0  0  0
   26.6942   -6.4732    0.0000 S   0  0  0  0  0  0  0  0  0  0  0  0
   28.2202   -6.1489    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   28.7021   -4.6654    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   27.6584   -3.5061    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   30.2281   -4.3411    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   30.7102   -2.8573    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   31.2718   -5.5002    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   32.7977   -5.1759    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   33.2799   -3.6923    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   34.8056   -3.3680    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   35.2878   -1.8845    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   36.8135   -1.5600    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   37.8575   -2.7193    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   39.3832   -2.3950    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   37.3753   -4.2029    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   35.8496   -4.5273    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   33.8415   -6.3352    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   35.3674   -6.0109    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   33.3595   -7.8189    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   34.4033   -8.9780    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   35.3636   -7.7488    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0
   35.7808   -9.7105    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   37.1036   -8.8839    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   35.8350  -11.2696    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   37.2125  -12.0019    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   33.9213  -10.4616    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   34.9650  -11.6209    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   32.3954  -10.7861    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   31.9134  -12.2696    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   32.9571  -13.4289    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   34.4831  -13.1046    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   35.5268  -14.2639    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   37.0527  -13.9395    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   35.0448  -15.7475    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   30.3875  -12.5939    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   29.9053  -14.0777    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   29.3437  -11.4348    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   27.8178  -11.7589    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   27.3358  -13.2427    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   25.8099  -13.5670    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   25.3277  -15.0507    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   24.7661  -12.4077    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   26.7740  -10.5998    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   27.2562   -9.1161    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   25.2481  -10.9241    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   22.1963  -11.5729    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
  1  2  1  0  0  0  0
  2  3  1  0  0  0  0
  3  4  1  0  0  0  0
  3  5  2  0  0  0  0
  6  1  1  0  0  0  0
  6  7  2  0  0  0  0
  8  6  1  0  0  0  0
  8  9  1  0  0  0  0
  9 10  1  0  0  0  0
 10 11  1  0  0  0  0
 10 12  1  0  0  0  0
  8 13  1  1  0  0  0
 14 13  1  0  0  0  0
 14 15  2  0  0  0  0
 16 14  1  6  0  0  0
 16 17  1  0  0  0  0
 17 18  1  0  0  0  0
 19 18  1  0  0  0  0
 19 20  1  0  0  0  0
 21 20  1  0  0  0  0
 22 21  1  6  0  0  0
 22 23  1  0  0  0  0
 23 24  1  0  0  0  0
 25 24  1  0  0  0  0
 26 25  1  0  0  0  0
 27 26  1  0  0  0  0
 27 28  1  6  0  0  0
 27 29  1  0  0  0  0
 29 30  2  0  0  0  0
 29 31  1  0  0  0  0
 31 32  1  0  0  0  0
 32 33  1  1  0  0  0
 33 34  1  0  0  0  0
 35 34  2  0  0  0  0
 36 35  1  0  0  0  0
 37 36  2  0  0  0  0
 37 38  1  0  0  0  0
 39 37  1  0  0  0  0
 40 39  2  0  0  0  0
 40 34  1  0  0  0  0
 32 41  1  0  0  0  0
 41 42  2  0  0  0  0
 41 43  1  0  0  0  0
 43 44  1  0  0  0  0
 44 45  1  6  0  0  0
 44 46  1  0  0  0  0
 46 47  1  1  0  0  0
 46 48  1  0  0  0  0
 48 49  1  0  0  0  0
 44 50  1  0  0  0  0
 50 51  2  0  0  0  0
 50 52  1  0  0  0  0
 52 53  1  0  0  0  0
 53 54  1  1  0  0  0
 54 55  1  0  0  0  0
 55 56  1  0  0  0  0
 56 57  1  0  0  0  0
 56 58  2  0  0  0  0
 53 59  1  0  0  0  0
 59 60  2  0  0  0  0
 59 61  1  0  0  0  0
 61 62  1  0  0  0  0
 62 63  1  1  0  0  0
 63 64  1  0  0  0  0
 64 65  1  0  0  0  0
 64 66  2  0  0  0  0
 62 67  1  0  0  0  0
 67 68  2  0  0  0  0
 67 69  1  0  0  0  0
 69 22  1  0  0  0  0
 21 70  2  0  0  0  0
 20 16  1  0  0  0  0
M  END`,
	    "1-ADAMANTYL-THPINACA":`
  Marvin  01132107332D          

 29 34  0  0  0  0            999 V2000
   17.1387   -2.6287    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   17.6875   -2.3751    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   17.7413   -1.7738    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   17.2473   -1.4276    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   17.3000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   18.3425   -0.9190    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   18.7839   -1.8665    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   18.1802   -2.7224    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   18.2887   -1.5202    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   16.6987   -1.6799    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   16.4154   -5.9832    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   17.1361   -6.3849    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   17.1485   -7.2099    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   16.4403   -7.6331    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   15.7197   -7.2314    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   15.7072   -6.4065    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   14.9866   -6.0049    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   13.4952   -4.8888    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   12.9339   -4.2841    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   13.1770   -3.4957    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   13.9812   -3.3120    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   14.5425   -3.9167    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   14.2995   -4.7051    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   14.9742   -5.1799    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   15.6343   -4.6850    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   15.3674   -3.9042    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   15.4953   -2.4810    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   16.6640   -3.3034    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   15.8423   -3.2296    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
  1  2  1  0  0  0  0
  2  3  1  0  0  0  0
  3  4  1  0  0  0  0
  4  5  1  0  0  0  0
  5  6  1  0  0  0  0
  6  7  1  0  0  0  0
  7  8  1  0  0  0  0
  1  8  1  0  0  0  0
  7  9  1  0  0  0  0
  3  9  1  0  0  0  0
  5 10  1  0  0  0  0
  1 10  1  0  0  0  0
 16 11  1  0  0  0  0
 11 12  1  0  0  0  0
 13 12  1  0  0  0  0
 13 14  1  0  0  0  0
 14 15  1  0  0  0  0
 15 16  1  0  0  0  0
 16 17  1  0  0  0  0
 17 24  1  0  0  0  0
 23 18  1  0  0  0  0
 19 18  2  0  0  0  0
 20 19  1  0  0  0  0
 21 20  2  0  0  0  0
 22 21  1  0  0  0  0
 22 26  1  0  0  0  0
 22 23  2  0  0  0  0
 23 24  1  0  0  0  0
 24 25  1  0  0  0  0
 25 26  2  0  0  0  0
 26 29  1  0  0  0  0
 29 27  2  0  0  0  0
 29 28  1  0  0  0  0
  1 28  1  0  0  0  0
M  END`,
	    "ADICILLIN":`
  Marvin  01132103422D          

 25 26  0  0  0  0            999 V2000
    7.4875   -2.5334    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    7.4875   -3.3584    0.0000 C   0  0  2  0  0  0  0  0  0  0  0  0
    8.3125   -3.3584    0.0000 C   0  0  2  0  0  0  0  0  0  0  0  0
    8.3125   -2.5334    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
    9.7366   -3.3584    0.0000 S   0  0  0  0  0  0  0  0  0  0  0  0
    9.7366   -2.5334    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    9.0204   -2.1167    0.0000 C   0  0  2  0  0  0  0  0  0  0  0  0
    6.9083   -1.9708    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    9.0183   -1.2917    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    9.7317   -0.8774    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    8.2778   -0.7852    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   10.3167   -1.9459    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   10.5292   -2.7459    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    8.3084   -4.1834    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0
    6.6625   -3.3584    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
    5.9459   -2.9459    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    5.2292   -3.3542    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    4.5125   -2.9417    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    3.7959   -3.3500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    3.0792   -2.9375    0.0000 C   0  0  2  0  0  0  0  0  0  0  0  0
    2.3625   -3.3459    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    2.3578   -4.1709    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    1.6504   -2.9293    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    5.9477   -2.1209    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    3.0750   -2.1125    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
  5  6  1  0  0  0  0
  6 13  1  0  0  0  0
  6  7  1  0  0  0  0
  3 14  1  1  0  0  0
  7  4  1  0  0  0  0
  3  5  1  0  0  0  0
  2 15  1  6  0  0  0
  3  4  1  0  0  0  0
 15 16  1  0  0  0  0
  1  8  2  0  0  0  0
 16 17  1  0  0  0  0
  4  1  1  0  0  0  0
 17 18  1  0  0  0  0
  7  9  1  1  0  0  0
 18 19  1  0  0  0  0
 19 20  1  0  0  0  0
  9 10  1  0  0  0  0
 20 21  1  0  0  0  0
  1  2  1  0  0  0  0
 21 22  2  0  0  0  0
  9 11  2  0  0  0  0
 21 23  1  0  0  0  0
  2  3  1  0  0  0  0
 16 24  2  0  0  0  0
  6 12  1  0  0  0  0
 20 25  1  6  0  0  0
M  END`
    };
    function convertMolToPath(){
      var mol = document.getElementById("molfile").value;
      var c=JSChemify.Chemical(mol);
      var smiles=c.toSmiles();
      var path =c.getShortPathNotation();
      document.getElementById("smiles-path").value=smiles + " " + path;
      renderSmiPath();
    }
    function convertPathToMol(){
      var smiPath = document.getElementById("smiles-path").value;
      var smi = smiPath.split(" ")[0];
      var path= smiPath.split(" ")[1];
      var c=JSChemify.Chemical(smi).setPathNotation(path);
      document.getElementById("molfile").value=c.toMol();
      renderMol();
    }
    function generateCoordinatesMol(){
      var mol = document.getElementById("molfile").value;
      var c=JSChemify.Chemical(mol).generateCoordinates();
      document.getElementById("molfile").value=c.toMol();
      renderMol();
    }
    function generateCoordinatesSmi(){
      var smiPath = document.getElementById("smiles-path").value;
      var smi = smiPath.split(" ")[0];
      var c=JSChemify.Chemical(smi).generateCoordinates();
      var path =c.getShortPathNotation();
      document.getElementById("smiles-path").value=smi + " " + path;
      renderSmiPath();
    }
    function renderSmiPath(){
      var smiPath = document.getElementById("smiles-path").value;
      var smi = smiPath.split(" ")[0];
      var path= smiPath.split(" ")[1];
      var c=JSChemify.Chemical(smi).setPathNotation(path);
      var smiSVG=c.getSVG();
      document.getElementById("smiles-path-img").innerHTML=smiSVG;
    }
    function renderMol(){
      var mol = document.getElementById("molfile").value;
      var c=JSChemify.Chemical(mol);
      var molSVG=c.getSVG();
      document.getElementById("molfile-img").innerHTML=molSVG;
    }
    function load(key){
    	  document.getElementById("molfile").value=examples[key];
    	    
    	  convertMolToPath();
    	  renderMol();
    }
    function makeExamples(){
        var buttonHTML=Object.keys(examples).map(e=>{
           return "<button onclick='load(\"" + e + "\")'>" + e + "</button>";
        }).join("");
       document.getElementById("examples").innerHTML=buttonHTML;
    }
	  
    function round(){
      var smiPath = document.getElementById("smiles-path").value;
      var smi = smiPath.split(" ")[0];
      var path= smiPath.split(" ")[1];
      var ePath=JSChemify.PathNotation()
	           .expand(path);
      ePath.map(pp=>{
      	let d=pp[0];
      	let m=pp[1];
      	let w=pp[2];
        var match=/([A-Za-z])([0-9.]*)/y.exec(d);
        
      
        var alpha=match[1];
        var numeric=match[2];
        if(numeric){
          numeric=Math.round(numeric-0);
        }else{
          numeric="";
        }
        var nd=alpha+numeric;
        if(nd==="D6"){ 
          nd="R";
        }else if(nd==="S6"){
          nd="L";
        }
        pp[0]=nd;
        if(m){
          match=/([A-Za-z])([0-9.]*)/y.exec(m);
          var mag=match[2]-0;
          mag=Math.round(mag/20)*20;
          if(mag===100){
            pp[1]="";
          }else{
            pp[1]=match[1] + mag;
          }
        }
	      
      });
      var c=JSChemify.Chemical(smi).setPathNotation(ePath);
      path =c.getShortPathNotation();
      document.getElementById("smiles-path").value=smi + " " + path;
      renderSmiPath();
	
    }
  </script>
  
</head>  
<body>
<div class="panel full">
  <h1>JSChemfiy Path Notation Example</h1>
  <p>
    This example shows the use of the PathNotation syntax for adding coordinates to a smiles string.
  </p>
  <p>
  Load Examples
    </p>
  <div id="examples">
    
  </div>
</div>	
<div class="panel col-3">
  <div id="molfile-img">
    
  </div>
<label for="molfile">Molfile</label>
<textarea class="nowrap" id="molfile">
  
  Marvin  01132102302D          

 41 44  0  0  1  0            999 V2000
   -2.2382   -2.6126    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.8246   -2.5747    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   -1.5524   -2.0825    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -1.9521   -3.4287    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -1.0728   -3.4119    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.9954   -2.1751    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.0085   -2.2339    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -3.7611   -2.6083    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   -0.3240   -3.8578    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    3.7779   -2.5916    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    4.5267   -2.1372    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.7220   -3.8411    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.9954   -1.2957    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   -1.5693   -1.2032    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.7530   -2.6588    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    4.5015   -1.2621    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    3.0080   -2.1708    0.0000 C   0  0  1  0  0  0  0  0  0  0  0  0
    2.2633   -2.6252    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.3029   -4.6741    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.3323   -3.4287    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -4.5100   -2.1708    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    1.0138   -4.6403    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    5.2924   -2.5578    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    1.4934   -2.2087    0.0000 C   0  0  2  0  0  0  0  0  0  0  0  0
    0.9971   -3.8284    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.3575   -5.0695    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    1.6701   -5.0863    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0
    2.9912   -1.2957    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    1.4767   -1.3336    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   -3.4246   -3.4287    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.7009   -4.6151    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.2677   -0.7025    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.9130   -0.7025    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -4.5352   -1.3462    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -5.1663   -2.5957    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -3.3867   -4.9811    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -4.1145   -3.7863    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -5.8394   -2.2129    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -5.2041   -0.9634    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -5.8562   -1.3926    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -4.0851   -4.5605    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
  2  3  1  0  0  0  0
  3  1  2  0  0  0  0
  4  1  1  0  0  0  0
  5  4  2  0  0  0  0
  6  1  1  0  0  0  0
  7  2  1  0  0  0  0
  8  6  1  0  0  0  0
  9  5  1  0  0  0  0
 10 17  1  0  0  0  0
 11 10  1  0  0  0  0
 12  4  1  0  0  0  0
 13  6  2  0  0  0  0
 14  3  1  0  0  0  0
 15  7  1  0  0  0  0
 16 11  2  0  0  0  0
 17 18  1  0  0  0  0
 18 24  1  0  0  0  0
 19  9  1  0  0  0  0
 20  9  2  0  0  0  0
 21  8  1  0  0  0  0
 22 25  2  0  0  0  0
 23 11  1  0  0  0  0
 24 15  1  0  0  0  0
 25 20  1  0  0  0  0
 26 19  2  0  0  0  0
 27 22  1  0  0  0  0
 17 28  1  1  0  0  0
 24 29  1  1  0  0  0
 30 12  1  0  0  0  0
 31 12  2  0  0  0  0
 32 14  1  0  0  0  0
 33 14  1  0  0  0  0
 34 21  1  0  0  0  0
 35 21  2  0  0  0  0
 36 31  1  0  0  0  0
 37 30  2  0  0  0  0
 38 35  1  0  0  0  0
 39 34  2  0  0  0  0
 40 39  1  0  0  0  0
 41 36  2  0  0  0  0
  5  2  1  0  0  0  0
 41 37  1  0  0  0  0
 22 26  1  0  0  0  0
 40 38  2  0  0  0  0
M  END
</textarea>
<button id="render-smiles" onclick="renderMol()">Render Image</button>
<button id="generate-coordinates-molfile" onclick="generateCoordinatesMol()">Generate Coordinates</button>
</div>
<div class="panel middle">
  <button id="convert-to-path" onclick="convertMolToPath()">Convert to Path Notation =&gt;</button>
  <button id="convert-to-mol" onclick="convertPathToMol()">&lt;= Convert to Molfile</button>
</div>
<div class="panel col-3">
  <div id="smiles-path-img">
    
  </div>
<label for="smiles-path">Smiles Path Notation</label>
<textarea id="smiles-path"></textarea>
<button id="render-smiles" onclick="renderSmiPath()">Render Image</button>
<button id="generate-coordinates-smiles" onclick="generateCoordinatesSmi()">Generate Coordinates</button>
<button id="round-path" onclick="round()">Round</button>
</div>
<script>
  convertMolToPath();
  renderMol();
  makeExamples();
</script>
</body> 
</html>
