<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charSet="utf-8" data-next-head=""/>
<style>
#controls {
  display: flex;
  align-items: center;
  gap: 20px;
  font: 16px Arial,sans-serif;
  margin: 20px;
}

#input, #output {
  flex: 1;
  height: 80vh;
  padding: 10px;
  font-size: 1rem;
  font-family: monospace;
  resize: none;
}

#bookName {
  align-self: flex-start;
  margin-bottom: 10px;
}

#compChk, label[for="compChk"] {
  display: block;
  margin-bottom: 10px;
}

#map, #unmap {
  display: block;
  margin-bottom: 10px;
}
</style>
  <script>
	  
let $ = (a)=>document.querySelector(a);
let brotli=null;
import("https://unpkg.com/brotli-wasm@3.0.0/index.web.js?module")
	 .then(m => m.default)
	 .then(b=>{
		 brotli=b;
	     init();
	 });

async function bufferToBase64(buffer) {
  // use a FileReader to generate a base64 data URI:
  const base64url = await new Promise(r => {
    const reader = new FileReader()
    reader.onload = () => r(reader.result)
    reader.readAsDataURL(new Blob([buffer]))
  });
  // remove the `data:...;base64,` part from the start
  return base64url.slice(base64url.indexOf(',') + 1);
}
	  
// Compress to base64
async function compress(text) {
  const compressedData = brotli.compress(new TextEncoder().encode(text)); 
  return await bufferToBase64(compressedData);
}

// Decompress from base64
let deCoM=(b64)=>{
	return new Promise((cb)=>cb((new TextDecoder()).decode(brotli.decompress(Uint8Array.from(atob(b64), c => c.charCodeAt(0))))));
}
	  
function mapCompressed(inp){
	return compress(inp).then(v=>{
            return v;
	});
}
function unmapCompressed(inp){
	var o = inp.trim();
	return deCoM(o);
}


</script>
</head>
<body>

	
<div>	
<a id="url" href="">As URL</a>
<input id="bookName" onchange="$('#url').innerHTML=$('#bookName').value;" value="As URL" />
</div>

	
<div id="controls">
<textarea id="input">
</textarea>
<button id="map">
ShrinkyDink
</button>
<button id="unmap">
Un-Shrinkydink
</button>
<textarea id="output">
G/wSIBwHuZnmPqFDzElLnfxvaXr35fRsJ5GIPpuPvGkibMbHtHIygzvsdlbFFrg0iEKPzwDxq+W3OndZJZJRCIWxGIlwbPfr6fu1u6QYp6fnh/2fHBVnQVKec2AUSlBotGA7sq72PRJSsb6bz3iJvn5hzczyngHmGKBbjkN21Bc193//arfsXUU858ABoAXy+COkclYppSHazRpE39aEjU/al2tJb930XrM1llJWUXiw/JsU8/1CP2f8jTdXu/urfk+VmzSJe2o17goh4KoaEkKjSEmUrK8cWFb7erSeyvrVKfPfqQAEwg3mDcqOxF0/0PdMRm2ATKgJo4ii+80wSdBJ/h/k9hb1LTxCeew6zquZUHNsnNZv3l4N3TLBeDwAAPjfwFomRezIKlKkHFkmJnaOwEZ/naypdjShUdV39MVMJ+tP6MlZjn4tp8EtmizWDtjoF17zdeNbWuOKtb5RtPF/c++eiksxIYB2N3q2+z29jy7eJFfNZ/mg0BwqbVvnouI4cCgmpwKPf1jGHCaDgAxz0yV7y1Xnd1cwHLX8oYFdpaqVE2/gzSv+fB/75jE1TMgNPzMGLW5syJRg/quKHme+tCSw2Z8caSEy8gyDakcsUeGcLhdSCgiUngd3fsSI6W0YxTCNbGbBi3TwA6XS9KQ2VCXIDpCbqHRTskKOO0LsxjVvobKLI2UBc6j1QHh04q9z7pf2p4BlQPyqcWiGhboMs8LNwdrYQWkRn81pjNv++puhTKgYmDdJlAOuzqQISjYQhr5BFJa+oOI/eLMszacm61DyJeg/mUiKSTliM6rcv2Mf+0l2NgWeTA5GSt3gnMT/bpvl7RX2upzdUnRWFr1EjaiOR1X7lxs/IMNgjYxP2LbI9lZVTt/Aj6fR9KrN7jiejOgIaJdN7royXr16BSiP++MkO5gmAiHIVlzfg5C/aTNkSLbZZKKh5EsasuLhIkwKGA27ob9Y/P/6/deXf2eFtrxdMKYri9NrGy22sVm/TlUEuVU4/Rh74qsTNZyCENewKv4cb1DjCSwgUdLlgSFZKCvDwMJWbV1d5vwujjDHlC3rLJ1c9hr6NwHtLR7nwsjoc3VBn2rOG0cyL66qeLDoM1IORpHSR3M+79/o/Z7mBgwlycoGoHks86sQQCaHNNCFb79ddsfjCZUR3zanFnNc+llf1cXhavBVjMneLxQA27GSYVAuDyqbUnE6bLOjdFE+cIFlwh4jwD+D0/4MkZD4jmCGq2LPROVfp0T31IkpOAqQXyJAbiIvWyq04sEqIKxIMKj0jsBQEaIBwTGKsO2LDpo0jAX5qcSi/DfL8t3mCpuFMcP4DIVGKtGIVBUqpwhRMnJ5asitV3QVkwqgJbOnbFct1iuVnK/Gu8F3jRUDVgj/pyChNDJmwxpSWjLw26vkAIiKbtSsEd3iTJXDV7AetlIhk78Q/0c3vsykhGVXrOpGIDfe7WboycCjaHLLnOL3C1SG2ltoPeusmXzorrqcy90JifVnzYtHGp7x+bKtqyn7rU2elSi5ivUbmGeYwDTPx7OcGoBrYNG0q+FONO/Am9UbFy6v7ZQoJGjplvUaFz6dg9TQy/HUnUHdH8ByJb+5HCCSBQ73sQk6g62VCQozJoOeIcZS+0hl0jLViwFrzthoiArZyi0KkB6WE6e75faKHf6Dt8GTlZ4aUvpzxQ8Ua59/EUP+ni1ojiuRHN6awLG7XVCcdl0ch26uIarUx6Uq7POQuf8rse3EkgaLzpFL9qVsUbQ+aZ/QviNa2JDtDq4p4vs5QhEQd7GmOsAA
</textarea>
</div>
<script>
	
$("#map").onclick=((e)=>{
	mapCompressed($("#input").value).then(m=>{
	  $("#output").value=m;
	  $("#url").href="https://tylerperyea.github.io/public/simple_web2.html?html="+m;
	});
});

$("#unmap").onclick=((e)=>{
  
	unmapCompressed($("#output").value).then(m=>{
	  $("#input").value=m;
	});
});
	
function init(){
    $("#unmap").onclick();
}
//$("#map").onclick();

</script>
</body>
</html>
